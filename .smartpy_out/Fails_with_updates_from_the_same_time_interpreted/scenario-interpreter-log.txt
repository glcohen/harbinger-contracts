Comment...
 h1: Fails with updates from the past
Comment...
 h2: GIVEN a Normalizer contract with an update at a given time = 1
Creating contract
 -> (Pair (Pair {"XTZ-USD"; "BTC-USD"} {Elt "BTC-USD" (Pair (Pair 0 "0") (Pair (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)) (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)))); Elt "XTZ-USD" (Pair (Pair 0 "0") (Pair (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)) (Pair (Pair 0 -1) (Pair {Elt 0 0} 0))))}) (Pair 3 "KT1QLPABNCD4z1cSYVv3ntYDYgtWTed7LkYr"))
 => ./.smartpy_out/Fails_with_updates_from_the_same_time_interpreted/testContractTypes.0.2.tz 2
 => ./.smartpy_out/Fails_with_updates_from_the_same_time_interpreted/testContractCode.0.2.tz 1224
 => ./.smartpy_out/Fails_with_updates_from_the_same_time_interpreted/testContractCode.0.2.tz.json 1183
 => ./.smartpy_out/Fails_with_updates_from_the_same_time_interpreted/testPrettyPrint.0.2.py 47
Executing update(sp.set_type_expr({'XTZ-USD' : (sp.timestamp(1), (sp.timestamp(2), (1, (2, (3, (4, 5))))))}, sp.TBigMap(sp.TString, sp.TPair(sp.TTimestamp, sp.TPair(sp.TTimestamp, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TNat)))))))))...
 -> (Pair (Pair {"XTZ-USD"; "BTC-USD"} {Elt "BTC-USD" (Pair (Pair 0 "0") (Pair (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)) (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)))); Elt "XTZ-USD" (Pair (Pair 3 "1") (Pair (Pair (Pair 0 0) (Pair {Elt 0 15} 15)) (Pair (Pair 0 0) (Pair {Elt 0 5} 5))))}) (Pair 3 "KT1QLPABNCD4z1cSYVv3ntYDYgtWTed7LkYr"))
Comment...
 h2: WHEN an update is provided at the same time.
Executing update(sp.set_type_expr({'XTZ-USD' : (sp.timestamp(1), (sp.timestamp(2), (6, (7, (8, (9, 10))))))}, sp.TBigMap(sp.TString, sp.TPair(sp.TTimestamp, sp.TPair(sp.TTimestamp, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TPair(sp.TNat, sp.TNat)))))))))...
 -> (Pair (Pair {"XTZ-USD"; "BTC-USD"} {Elt "BTC-USD" (Pair (Pair 0 "0") (Pair (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)) (Pair (Pair 0 -1) (Pair {Elt 0 0} 0)))); Elt "XTZ-USD" (Pair (Pair 3 "1") (Pair (Pair (Pair 0 0) (Pair {Elt 0 15} 15)) (Pair (Pair 0 0) (Pair {Elt 0 5} 5))))}) (Pair 3 "KT1QLPABNCD4z1cSYVv3ntYDYgtWTed7LkYr"))
Comment...
 h2: THEN the original time is still reported.
Verifying sp.contract_data(0).assetMap['XTZ-USD'].computedPrice == 3...
 => ./.smartpy_out/Fails_with_updates_from_the_same_time_interpreted/testVerify.7.tz 35
 OK